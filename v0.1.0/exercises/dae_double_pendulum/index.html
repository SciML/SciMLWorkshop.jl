<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Differential-Algebraic Equation Modeling of a Double Pendulum (B) · SciML Workshop</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/SciMLWorkshop/stable/exercises/dae_double_pendulum/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SciML Workshop logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SciML Workshop</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SciMLWorkshop: Workshop Materials for Training in Scientific Computing and Scientific Machine Learning (SciML)</a></li><li><span class="tocitem">Exercises</span><ul><li><a class="tocitem" href="../mtk_chemical_reaction/">ModelingToolkit Simple Chemical Reaction ODE (B)</a></li><li><a class="tocitem" href="../stiffbio_uncertainty/">Investigating Sources of Randomness and Uncertainty in a Stiff Biological System (B)</a></li><li><a class="tocitem" href="../hybriddelay_pharmacokinetics/">Fitting Hybrid Delay Pharmacokinetic Models with Automated Responses (B)</a></li><li class="is-active"><a class="tocitem" href>Differential-Algebraic Equation Modeling of a Double Pendulum (B)</a><ul class="internal"><li><a class="tocitem" href="#Part-1:-Simple-Introduction-to-DAEs:-Mass-Matrix-Robertson-Equations"><span>Part 1: Simple Introduction to DAEs: Mass-Matrix Robertson Equations</span></a></li><li><a class="tocitem" href="#Part-2:-Solving-the-Implicit-Robertson-Equations-with-IDA"><span>Part 2: Solving the Implicit Robertson Equations with IDA</span></a></li><li><a class="tocitem" href="#Part-3:-Manual-Index-Reduction-of-the-Single-Pendulum"><span>Part 3: Manual Index Reduction of the Single Pendulum</span></a></li><li><a class="tocitem" href="#Part-4:-Single-Pendulum-Solution-with-IDA"><span>Part 4: Single Pendulum Solution with IDA</span></a></li><li><a class="tocitem" href="#Part-5:-Solving-the-Double-Penulum-DAE-System"><span>Part 5: Solving the Double Penulum DAE System</span></a></li></ul></li><li><a class="tocitem" href="../acausal_circuit/">RLC Circuit Acausal Model (I)</a></li><li><a class="tocitem" href="../performance_pde/">Performance Optimizing and Parallelizing Semilinear PDE Solvers (I)</a></li><li><a class="tocitem" href="../gsa_henon_heiles/">Global Parameter Sensitivity and Optimality with GPU and Distributed Ensembles (B)</a></li><li><a class="tocitem" href="../neural_sde/">Training Neural Stochastic Differential Equations with GPU acceleration (I)</a></li><li><a class="tocitem" href="../dc_motor_control/">Controlling a DC Motor (E)</a></li></ul></li><li><span class="tocitem">Selected Solutions</span><ul><li><a class="tocitem" href="../../solutions/mtk_chemical_reaction/">ModelingToolkit Simple Chemical Reaction ODE (B)</a></li><li><a class="tocitem" href="../../solutions/stiffbio_uncertainty/">Investigating Sources of Randomness and Uncertainty in a Stiff Biological System (B)</a></li><li><a class="tocitem" href="../../solutions/hybriddelay_pharmacokinetics/">Fitting Hybrid Delay Pharmacokinetic Models with Automated Responses (B)</a></li><li><a class="tocitem" href="../../solutions/dae_double_pendulum/">Differential-Algebraic Equation Modeling of a Double Pendulum (B)</a></li><li><a class="tocitem" href="../../solutions/acausal_circuit/">RLC Circuit Acausal Model (I)</a></li><li><a class="tocitem" href="../../solutions/performance_pde/">Performance Optimizing and Parallelizing Semilinear PDE Solvers (I)</a></li><li><a class="tocitem" href="../../solutions/gsa_henon_heiles/">Global Parameter Sensitivity and Optimality with GPU and Distributed Ensembles (B)</a></li><li><a class="tocitem" href="../../solutions/neural_sde/">Training Neural Stochastic Differential Equations with GPU acceleration (I)</a></li><li><a class="tocitem" href="../../solutions/dc_motor_control/">Controlling a DC Motor (E)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Exercises</a></li><li class="is-active"><a href>Differential-Algebraic Equation Modeling of a Double Pendulum (B)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Differential-Algebraic Equation Modeling of a Double Pendulum (B)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/SciMLWorkshop.jl/blob/main/docs/src/exercises/dae_double_pendulum.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Differential-Algebraic-Equation-Modeling-of-a-Double-Pendulum-(B)"><a class="docs-heading-anchor" href="#Differential-Algebraic-Equation-Modeling-of-a-Double-Pendulum-(B)">Differential-Algebraic Equation Modeling of a Double Pendulum (B)</a><a id="Differential-Algebraic-Equation-Modeling-of-a-Double-Pendulum-(B)-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Algebraic-Equation-Modeling-of-a-Double-Pendulum-(B)" title="Permalink"></a></h1><p>Differential-Algebraic Equaton (DAE) systems are like ODEs but allow for adding constraints into the models. This problem will look at solving the double penulum problem with enforcement of the rigid body constraints, requiring that the total distance <code>L</code> is constant throughout the simulation. While these equations can be rewritten in an ODE form, in many cases it can be simpler to solve the equation directly with the constraints. This tutorial will cover both the idea of index, how to manually perform index reduction, and how to make use of mass matrix and implicit ODE solvers to handle these problems.</p><h2 id="Part-1:-Simple-Introduction-to-DAEs:-Mass-Matrix-Robertson-Equations"><a class="docs-heading-anchor" href="#Part-1:-Simple-Introduction-to-DAEs:-Mass-Matrix-Robertson-Equations">Part 1: Simple Introduction to DAEs: Mass-Matrix Robertson Equations</a><a id="Part-1:-Simple-Introduction-to-DAEs:-Mass-Matrix-Robertson-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Part-1:-Simple-Introduction-to-DAEs:-Mass-Matrix-Robertson-Equations" title="Permalink"></a></h2><p>A mass-matrix ordinary differential equation (ODE) is an ODE where the left-hand side, the derivative side, is multiplied by a matrix known as the mass matrix. This is described as:</p><p class="math-container">\[Mu&#39; = f(u,p,t)\]</p><p>where <span>$M$</span> is the mass matrix. When <span>$M$</span> is invertible, there is an ODE which is equivalent to this formulation. When <span>$M$</span> is not invertible, this can have a distinctly different behavior and is as Differential-Algebraic Equation (DAE).</p><p>Solve the Robertson DAE:</p><p class="math-container">\[\begin{align*}
\frac{dy_1}{dt} &amp;= -0.04y_1 + 10^4 y_2y_3\\
\frac{dy_2}{dt} &amp;=  0.04y_1 - 10^4 y_2y_3 - 3\times 10^7 y_2^2\\
1 &amp;= y_1 + y_2 + y_3
\end{align*}\]</p><p>with <span>$y(0) = [1,0,0]$</span> and <span>$dy(0) = [-0.04,0.04,0.0]$</span> using the mass-matrix formulation and <code>Rodas5()</code>. Use the <a href="https://docs.sciml.ai/dev/types/ode_types">ODEProblem page</a> to find out how to declare a mass matrix.</p><p>(Hint: what if the last row has all zeros?)</p><h2 id="Part-2:-Solving-the-Implicit-Robertson-Equations-with-IDA"><a class="docs-heading-anchor" href="#Part-2:-Solving-the-Implicit-Robertson-Equations-with-IDA">Part 2: Solving the Implicit Robertson Equations with IDA</a><a id="Part-2:-Solving-the-Implicit-Robertson-Equations-with-IDA-1"></a><a class="docs-heading-anchor-permalink" href="#Part-2:-Solving-the-Implicit-Robertson-Equations-with-IDA" title="Permalink"></a></h2><p>Use the <a href="https://docs.sciml.ai/dev/tutorials/dae_example">DAE Tutorial</a> to define a DAE in its implicit form and solve the Robertson equation with IDA. Why is <code>differential_vars = [true,true,false]</code>?</p><h2 id="Part-3:-Manual-Index-Reduction-of-the-Single-Pendulum"><a class="docs-heading-anchor" href="#Part-3:-Manual-Index-Reduction-of-the-Single-Pendulum">Part 3: Manual Index Reduction of the Single Pendulum</a><a id="Part-3:-Manual-Index-Reduction-of-the-Single-Pendulum-1"></a><a class="docs-heading-anchor-permalink" href="#Part-3:-Manual-Index-Reduction-of-the-Single-Pendulum" title="Permalink"></a></h2><p>The index of a DAE is a notion used to measure distance from its related ODE. There are many different definitions of index, but we&#39;re going to stick to the idea of differential index: the number of differentiations required to convert a system of DAEs into explicit ODE form. DAEs of high index are usually transformed via a procedure called index reduction. The following example will demonstrate this.</p><p>Consider the index 3 DAE system of the cartesian pendulum. After writing down the force equations in both directions, we arrive at the following DAE:</p><p class="math-container">\[\begin{align*}
m\ddot{x} &amp;= \frac{x}{L}T \\
m\ddot{y} &amp;= \frac{y}{L}T - mg \\
x^2 + y^2 &amp;= L
\end{align*}\]</p><p>Notice that we don&#39;t have an equation describing the behaviour of <code>T</code>. Let us now perform index reduction to extract an equation for <code>T</code></p><p>Differentiate this third equation twice with respect to time to reduce it from index 3 to index 1.</p><h2 id="Part-4:-Single-Pendulum-Solution-with-IDA"><a class="docs-heading-anchor" href="#Part-4:-Single-Pendulum-Solution-with-IDA">Part 4: Single Pendulum Solution with IDA</a><a id="Part-4:-Single-Pendulum-Solution-with-IDA-1"></a><a class="docs-heading-anchor-permalink" href="#Part-4:-Single-Pendulum-Solution-with-IDA" title="Permalink"></a></h2><p>Write these equations in implicit form and solve the system using IDA.</p><h2 id="Part-5:-Solving-the-Double-Penulum-DAE-System"><a class="docs-heading-anchor" href="#Part-5:-Solving-the-Double-Penulum-DAE-System">Part 5: Solving the Double Penulum DAE System</a><a id="Part-5:-Solving-the-Double-Penulum-DAE-System-1"></a><a class="docs-heading-anchor-permalink" href="#Part-5:-Solving-the-Double-Penulum-DAE-System" title="Permalink"></a></h2><p>The following equations describe a double pendulum system:</p><p class="math-container">\[\begin{align*}
m_2\ddot{x_2} &amp;= \frac{x_2}{L_2}T_2 \\
m_2\ddot{y_2} &amp;= \frac{y_2}{L_2}T_2 - m_2g \\
{x_2}^2 + {y_2}^2 &amp;= L_2 \\
m_1\ddot{x_1} &amp;= \frac{x_1}{L_1}T_1 - \frac{x_2}{L_2}T_2 \\
m_2\ddot{y_1} &amp;= \frac{y_1}{L_1}T_2 - m_1g - \frac{y_2}{L_2}T_2 \\
{x_1}^2 + {y_1}^2 &amp;= L_1 \\
\end{align*}\]</p><p>Perform index reduction and solve it like in the previous example.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hybriddelay_pharmacokinetics/">« Fitting Hybrid Delay Pharmacokinetic Models with Automated Responses (B)</a><a class="docs-footer-nextpage" href="../acausal_circuit/">RLC Circuit Acausal Model (I) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 13 December 2022 11:57">Tuesday 13 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
